package br.com.martins_borges.telas;


import br.com.martins_borges.interfaces.PneuDataChangeListener;
import br.com.martins_borges.utilitarios.SortHeaderRenderer;
import javax.swing.table.JTableHeader; // Certifique-se que este import exista
import javax.swing.RowSorter; // E este também
import br.com.martins_borges.dal.ModeloPneuDAO;
import br.com.martins_borges.dal.MedidaPneuDAO;
import br.com.martins_borges.dal.TipoPneuDAO;
import br.com.martins_borges.dal.FabricanteDAO;
import br.com.martins_borges.dal.FornecedorDAO;
import br.com.martins_borges.dal.PneuDAO;
import br.com.martins_borges.model.Fabricante;
import br.com.martins_borges.model.Fornecedor;
import br.com.martins_borges.model.MedidaPneu;
import br.com.martins_borges.model.ModeloPneu;
import br.com.martins_borges.model.Pneu;
import br.com.martins_borges.model.TipoPneu;
import br.com.martins_borges.utilitarios.Utilitarios;
import br.com.martins_borges.utilitarios.TamanhoTabela;
import java.awt.Color;
import java.awt.Component;
import java.awt.event.FocusAdapter;
import java.awt.event.FocusEvent;
import java.awt.event.ItemEvent;
import java.awt.event.ItemListener;
import java.awt.event.KeyAdapter;
import java.awt.event.KeyEvent;
import java.awt.event.MouseListener;
import java.awt.event.MouseMotionListener;
import java.text.NumberFormat;
import java.text.ParseException;
import java.time.LocalDate;
import java.time.format.DateTimeFormatter;
import java.util.ArrayList;
import java.util.List;
import java.util.Locale;
import javax.swing.Box;
import javax.swing.BoxLayout;
import javax.swing.JOptionPane;
import javax.swing.table.DefaultTableModel;
import javax.swing.ButtonGroup;
import javax.swing.DefaultComboBoxModel;
import javax.swing.InputMap;
import javax.swing.JComboBox;
import javax.swing.JComponent;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.JTextField;
import javax.swing.KeyStroke;
import javax.swing.SwingConstants;
import javax.swing.table.TableColumnModel;
import javax.swing.text.AbstractDocument;
import javax.swing.text.DefaultEditorKit;
import javax.swing.text.JTextComponent;
import javax.swing.event.DocumentEvent;
import javax.swing.event.DocumentListener;
import javax.swing.text.AttributeSet;
import javax.swing.text.BadLocationException;
import javax.swing.text.DocumentFilter;
import javax.swing.text.DocumentFilter.FilterBypass;

// <editor-fold defaultstate="collapsed" desc="Declarações de Atributos">
public class TelaCadastroPneus extends javax.swing.JDialog {

    private final FornecedorDAO fornecedorDAO = new FornecedorDAO();
    private final FabricanteDAO fabricanteDAO = new FabricanteDAO();
    private final ModeloPneuDAO modeloPneuDAO = new ModeloPneuDAO();
    private final MedidaPneuDAO medidaPneuDAO = new MedidaPneuDAO();
    private final TipoPneuDAO tipoPneuDAO = new TipoPneuDAO();
    private final PneuDAO pneuDAO = new PneuDAO();
    private ButtonGroup grupoEmpresas;
    private final NumberFormat currencyFormatter = NumberFormat.getCurrencyInstance(new Locale("pt", "BR"));
    private final DateTimeFormatter dateFormatter = DateTimeFormatter.ofPattern("dd/MM/yyyy");
    private boolean modoEdicao = false;
    private int idPneuEmEdicao = -1;
    private final NumberFormat currencyFormat = NumberFormat.getCurrencyInstance(new Locale("pt", "BR"));
    private static final int ID_EMPRESA_MARTINS_BORGES = 1;
    private static final int ID_EMPRESA_ALB = 2;
    private static final int ID_EMPRESA_ENGEUDI = 3;

    private final List<Pneu> pneusExibidosNoFiltro = new ArrayList<>();
    private javax.swing.table.TableRowSorter<javax.swing.table.TableModel> sorter;

    private List<String> fornecedorNomes = new ArrayList<>();
    private List<String> fabricanteNomes = new ArrayList<>();
    private List<String> modeloPneuNomes = new ArrayList<>();
    private List<String> medidaPneuNomes = new ArrayList<>();
    private List<String> tipoPneuNomes = new ArrayList<>();

    private Runnable onCadastroSucessoCallback;
    
    // Listener para notificação de alterações nos dados de pneus
    private PneuDataChangeListener dataChangeListener;

    public void setOnCadastroSucessoCallback(Runnable callback) {
        this.onCadastroSucessoCallback = callback;
    }
    
    
    public void setDataChangeListener(PneuDataChangeListener listener) {
        this.dataChangeListener = listener;
    }
// </editor-fold>
    
    public TelaCadastroPneus(java.awt.Frame parent, boolean modal) {
        super(parent, modal);
        initComponents();

        // Adiciona o listener para a tecla ESC
        getRootPane().getInputMap(javax.swing.JComponent.WHEN_IN_FOCUSED_WINDOW).put(
            javax.swing.KeyStroke.getKeyStroke(java.awt.event.KeyEvent.VK_ESCAPE, 0), "escape");
        getRootPane().getActionMap().put("escape", new javax.swing.AbstractAction() {
            public void actionPerformed(java.awt.event.ActionEvent e) {
                dispose(); // Fecha a janela
            }
        });

        aplicarFiltroMaiusculasAosCampos();
        adicionarListenersValor();
        criarGrupoEmpresas();
        configuracoesIniciais();
        Utilitarios.aplicarFormatacaoCampos(this.getContentPane());

        // Define um tamanho preferencial e centraliza a janela.
        definirTamanhoEPosicao();
    }

    private String resolveComboBoxSelection(JComboBox<String> comboBox, List<String> fullOptionsList, String fieldName) {
        String typedText = ((JTextField) comboBox.getEditor().getEditorComponent()).getText().trim();
        if (typedText.isEmpty()) {
            JOptionPane.showMessageDialog(this, "O campo '" + fieldName + "' é obrigatório.", "Campo Obrigatório", JOptionPane.WARNING_MESSAGE);
            comboBox.requestFocusInWindow();
            return null;
        }

        for (String option : fullOptionsList) {
            if (option.trim().equalsIgnoreCase(typedText)) {
                return option.trim().toUpperCase();
            }
        }

        JOptionPane.showMessageDialog(this, "O valor '" + typedText + "' não corresponde a um item válido em '" + fieldName + "'. Por favor, selecione um item da lista.", "Seleção Inválida", JOptionPane.WARNING_MESSAGE);
        comboBox.requestFocusInWindow();
        return null;
    }

    private void definirTamanhoEPosicao() {
        // O código é executado no Event Dispatch Thread para garantir que o Frame pai já tenha um tamanho.
        javax.swing.SwingUtilities.invokeLater(() -> {
            java.awt.Window parent = javax.swing.SwingUtilities.getWindowAncestor(this);
            if (parent != null) {
                // Define um tamanho fixo, porém razoável, para a janela.
                int frameWidth = 1110;
                int frameHeight = 710;
                setSize(frameWidth, frameHeight);

                // Calcula a posição para centralizar em relação ao pai.
                int x = parent.getLocation().x + (parent.getWidth() - frameWidth) / 2;
                int y = parent.getLocation().y + (parent.getHeight() - frameHeight) / 2;

                // Adiciona um deslocamento para ajustar a posição.
                x -= 50; // Move 50 pixels para a esquerda para um melhor ajuste visual.
                y += 30; // Move 30 pixels para baixo para não cobrir o menu.

                // Garante que a janela não fique com coordenadas negativas.
                x = Math.max(0, x);
                y = Math.max(0, y);

                setLocation(x, y);
            }
        });
    }

    private void aplicarFiltroMaiusculasAosCampos() {

        if (TxtObs != null) {
            aplicarFiltroMaiusculas(TxtObs);
        }
        if (TxtDot != null) {
            aplicarFiltroMaiusculas(TxtDot);
        }
        aplicarFiltroEditorComboBox(CbFornecedor);
        aplicarFiltroEditorComboBox(CbFabricante);
        aplicarFiltroEditorComboBox(CbModelo);
        aplicarFiltroEditorComboBox(CbMedida);
        aplicarFiltroEditorComboBox(CbTipoPneu);

    }

    private void aplicarFiltroEditorComboBox(JComboBox<?> comboBox) {
        if (comboBox == null) {
            return;
        }
        try {
            Component editorComp = comboBox.getEditor().getEditorComponent();
            if (editorComp instanceof JTextComponent) {
                aplicarFiltroMaiusculas((JTextComponent) editorComp);
            }
        } catch (Exception e) {
            System.err.println("ERRO aplicar filtro editor Combo: " + e.getMessage());
        }
    }

    private void aplicarFiltroMaiusculas(JTextComponent textComponent) {
        if (textComponent != null && textComponent.getDocument() instanceof AbstractDocument) {
            ((AbstractDocument) textComponent.getDocument()).setDocumentFilter(new DocumentFilter() {
                @Override
                public void insertString(FilterBypass fb, int offset, String string, AttributeSet attr) throws BadLocationException {
                    if (string != null) {
                        fb.insertString(offset, string.toUpperCase(), attr);
                    }
                }

                @Override
                public void replace(FilterBypass fb, int offset, int length, String text, AttributeSet attrs) throws BadLocationException {
                    if (text != null) {
                        fb.replace(offset, length, text.toUpperCase(), attrs);
                    }
                }
            });
        }
    }

    private List<String> obterPrefixosPermitidos(int idEmpresa) {
        switch (idEmpresa) {
            case 1:

                return List.of("275", "295", "900", "1000", "1100");
            case 2:

                return List.of("275", "295");
            case 3:

                return List.of("275", "295", "1200");
            default:
                return new ArrayList<>();
        }
    }

    private void atualizarOpcoesMedida() {
        List<String> prefixosPermitidos = new ArrayList<>();
        boolean algumaEmpresaSelecionada = false;

        if (MARTINS_BORGES.isSelected()) {
            prefixosPermitidos = List.of("275", "295", "900", "1000", "1100");
            algumaEmpresaSelecionada = true;
        } else if (ALB.isSelected()) {
            prefixosPermitidos = List.of("275", "295");
            algumaEmpresaSelecionada = true;
        } else if (ENGEUDI.isSelected()) {
            prefixosPermitidos = List.of("275", "295", "1200");
            algumaEmpresaSelecionada = true;

        }

        if (!algumaEmpresaSelecionada) {
            CbMedida.setEnabled(false);
           popularComboBoxMedida(new ArrayList<>());
            return;
        }

        List<String> todasAsMedidas = medidaPneuDAO.listarNomes();
        List<String> medidasFiltradas = new ArrayList<>();

        if (todasAsMedidas != null) {
            for (String medidaCompletaOriginal : todasAsMedidas) {
                String medidaTrimmed = medidaCompletaOriginal.trim();
                for (String prefixo : prefixosPermitidos) {

                    if (medidaTrimmed.startsWith(prefixo)) {
                        medidasFiltradas.add(medidaCompletaOriginal);
                        break;
                    }
                }
            }
        }

        CbMedida.setEnabled(true);
        popularComboBoxMedida(medidasFiltradas);
    }

    private void adicionarListenersValor() {
        if (TxtValor == null) {
            System.err.println("ERRO: TxtValor não inicializado!");
            return;
        }
        TxtValor.setHorizontalAlignment(SwingConstants.RIGHT);
        TxtValor.setText("");

        TxtValor.addFocusListener(new FocusAdapter() {
            @Override
            public void focusLost(FocusEvent e) {
                formatarValorAoSair();
            }

        });

        TxtValor.addKeyListener(new KeyAdapter() {
            @Override
            public void keyTyped(KeyEvent evt) {
                char c = evt.getKeyChar();
                String texto = TxtValor.getText();

                if (!Character.isDigit(c) && (c != ',' || texto.contains(","))
                        && c != KeyEvent.VK_BACK_SPACE && c != KeyEvent.VK_DELETE && !Character.isISOControl(c)) {
                    evt.consume();
                }
            }
        });
    }

    private void formatarValorAoSair() {
        if (TxtValor == null) {
            return;
        }
        String texto = TxtValor.getText().trim();
        if (texto.isEmpty()) {
            TxtValor.setText("");
            return;
        }

        try {
            String textoNumerico = texto.replace(".", "").replace(",", ".");
            if (textoNumerico.isEmpty()) {
                TxtValor.setText("");
                return;
            }
            double valor = Double.parseDouble(textoNumerico);
            TxtValor.setText(currencyFormat.format(valor));
        } catch (NumberFormatException ex) {
            JOptionPane.showMessageDialog(this, "Valor monetário inválido: " + texto,
                    "Formato Inválido", JOptionPane.WARNING_MESSAGE);
            TxtValor.setText("");
        }
    }

    private void criarGrupoEmpresas() {
        grupoEmpresas = new ButtonGroup();

        java.awt.event.ActionListener empresaListener = evt -> {
            atualizarOpcoesMedida();
            if (Novo.isSelected()) {
                sugerirProximoFogo();
            } else {
                aplicarFiltroPneus();
            }
        };

        MARTINS_BORGES.setActionCommand("MARTINS_BORGES");
        MARTINS_BORGES.addActionListener(empresaListener);
        grupoEmpresas.add(MARTINS_BORGES);
        ALB.setActionCommand("ALB");
        ALB.addActionListener(empresaListener);
        grupoEmpresas.add(ALB);

        ENGEUDI.setActionCommand("ENGEUDI");
        ENGEUDI.addActionListener(empresaListener);
        grupoEmpresas.add(ENGEUDI);
    }

    
    private void adicionarListenerClickFora() {
        // Adiciona um listener global que captura TODOS os cliques na janela
        java.awt.event.MouseAdapter listenerGlobal = new java.awt.event.MouseAdapter() {
            @Override
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                // Ignora cliques nos próprios checkboxes, deixando seus ActionListeners tratarem o evento.
                java.awt.Component clickedComponent = evt.getComponent();
                if (clickedComponent == Novo ||
                    clickedComponent == MARTINS_BORGES ||
                    clickedComponent == ALB ||
                    clickedComponent == ENGEUDI) {
                    return;
                }

                // Se estiver em modo de novo cadastro, não faz nada ao clicar fora.
                if (Novo.isSelected()) {
                    return;
                }

                // Se não estiver em modo de novo cadastro, um clique fora limpa a seleção das empresas.
                if (grupoEmpresas != null) {
                    grupoEmpresas.clearSelection();
                    atualizarOpcoesMedida();
                    aplicarFiltroPneus();
                }
            }
        };

        // Adiciona o listener nos painéis principais
        this.addMouseListener(listenerGlobal);
        if (jCadastro1 != null) {
            jCadastro1.addMouseListener(listenerGlobal);
        }
        if (jCadastro2 != null) {
            jCadastro2.addMouseListener(listenerGlobal);
        }
        if (Empresas != null) {
            Empresas.addMouseListener(listenerGlobal);
        }
    }
    
    
    private boolean isClickOnCheckbox(java.awt.event.MouseEvent evt) {
        java.awt.Point clickPoint = evt.getPoint();
        
        // Converte as coordenadas do clique para as coordenadas dos checkboxes
        if (MARTINS_BORGES != null && MARTINS_BORGES.isVisible()) {
            java.awt.Point checkboxLocation = javax.swing.SwingUtilities.convertPoint(
                this, clickPoint, Empresas);
            if (MARTINS_BORGES.getBounds().contains(checkboxLocation)) {
                return true;
            }
        }
        
        if (ALB != null && ALB.isVisible()) {
            java.awt.Point checkboxLocation = javax.swing.SwingUtilities.convertPoint(
                this, clickPoint, Empresas);
            if (ALB.getBounds().contains(checkboxLocation)) {
                return true;
            }
        }
        
        if (ENGEUDI != null && ENGEUDI.isVisible()) {
            java.awt.Point checkboxLocation = javax.swing.SwingUtilities.convertPoint(
                this, clickPoint, Empresas);
            if (ENGEUDI.getBounds().contains(checkboxLocation)) {
                return true;
            }
        }
        
        return false;
    }

    
   private boolean isClickOnCheckboxInPanel(java.awt.event.MouseEvent evt, javax.swing.JPanel sourcePanel) {
        java.awt.Point clickPoint = evt.getPoint();
        
        // Verifica cada checkbox individualmente
        if (MARTINS_BORGES != null && MARTINS_BORGES.isVisible()) {
            java.awt.Point checkboxLocation = javax.swing.SwingUtilities.convertPoint(
                sourcePanel, clickPoint, Empresas);
            if (MARTINS_BORGES.getBounds().contains(checkboxLocation)) {
                return true;
            }
        }
        
        if (ALB != null && ALB.isVisible()) {
            java.awt.Point checkboxLocation = javax.swing.SwingUtilities.convertPoint(
                sourcePanel, clickPoint, Empresas);
            if (ALB.getBounds().contains(checkboxLocation)) {
                return true;
            }
        }
        
        if (ENGEUDI != null && ENGEUDI.isVisible()) {
            java.awt.Point checkboxLocation = javax.swing.SwingUtilities.convertPoint(
                sourcePanel, clickPoint, Empresas);
            if (ENGEUDI.getBounds().contains(checkboxLocation)) {
                return true;
            }
        }
        
        return false;
    }

    private void configuracoesIniciais() {
        adicionarListenerClickFora();

        popularComboBoxFornecedor();
        popularComboBoxFabricante();
        popularComboBoxModelo();
        configurarCampoNumerico(txtFogo);
        configurarCampoNumerico(TxtDot);
        configurarCampoNumerico(TxtProfud);
        configurarCampoNumerico(TxtProjecao);
        configurarCampoNumerico(TxtRecap);
        popularComboBoxTipoPneu();

        // Implementação de autocompletar usando Swing padrão
        try {
            configurarAutoCompletar(CbFornecedor);
            configurarAutoCompletar(CbFabricante);
            configurarAutoCompletar(CbModelo);
            configurarAutoCompletar(CbMedida);
            configurarAutoCompletar(CbTipoPneu);
        } catch (Exception e) {
            System.err.println("Erro ao configurar autocompletar: " + e.getMessage());
        }

        DefaultTableModel tableModel = new DefaultTableModel(
                new Object[][]{},
                new String[]{
                    "ID", "EMPR", "FOGO", "FORNECEDOR", "VALOR", "FABRICANTE", "TIPO PNEU", "MODELO", "DOT", "MEDIDA", "PROFUND.", "DATA", "RECAP.", "PROJ. KM", "OBS"
                }
        ) {
            @Override
            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return false;
            }
        };
        Tabela_Exibicao.setModel(tableModel);

        Tabela_Exibicao.addMouseListener(new java.awt.event.MouseAdapter() {
            @Override
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                Tabela_ExibicaoMouseClicked(evt);
            }
        });

        try {
            KeyStroke backspaceKey = KeyStroke.getKeyStroke(KeyEvent.VK_BACK_SPACE, 0);
            KeyStroke deleteKey = KeyStroke.getKeyStroke(KeyEvent.VK_DELETE, 0);
            String deletePrevAction = DefaultEditorKit.deletePrevCharAction;
            String deleteNextAction = DefaultEditorKit.deleteNextCharAction;
            configurarBindingsEditor(CbFornecedor, backspaceKey, deletePrevAction, deleteKey, deleteNextAction);
            configurarBindingsEditor(CbFabricante, backspaceKey, deletePrevAction, deleteKey, deleteNextAction);
            configurarBindingsEditor(CbModelo, backspaceKey, deletePrevAction, deleteKey, deleteNextAction);
            configurarBindingsEditor(CbMedida, backspaceKey, deletePrevAction, deleteKey, deleteNextAction);
            configurarBindingsEditor(CbTipoPneu, backspaceKey, deletePrevAction, deleteKey, deleteNextAction);
        } catch (Exception e) {
            System.err.println("Erro ao configurar Key Bindings dos ComboBoxes: " + e.getMessage());
        }

        Tabela_Exibicao.setShowGrid(true);
        Tabela_Exibicao.setGridColor(java.awt.Color.LIGHT_GRAY);

        this.sorter = new javax.swing.table.TableRowSorter<>(Tabela_Exibicao.getModel());
        Tabela_Exibicao.setRowSorter(this.sorter);

        txtFogo.getDocument().addDocumentListener(new DocumentListener() {
            @Override
            public void insertUpdate(DocumentEvent e) {
                if (!Novo.isSelected()) aplicarFiltroPneus();
            }
            @Override
            public void removeUpdate(DocumentEvent e) {
                if (!Novo.isSelected()) aplicarFiltroPneus();
            }
            @Override
            public void changedUpdate(DocumentEvent e) {
                // Não é necessário para JTextField simples
            }
        });

        Novo.addActionListener(evt -> {
            if (Novo.isSelected()) {
                limparCamposParaNovoCadastro();
                sugerirProximoFogo();
                txtFogo.setEditable(true);

                DefaultTableModel modeloTabela = (DefaultTableModel) Tabela_Exibicao.getModel();
                modeloTabela.setNumRows(0);
                pneusExibidosNoFiltro.clear();

                Pneu ultimoPneu = pneuDAO.buscarUltimoPneuCadastrado();
                if (ultimoPneu != null) {
                    pneusExibidosNoFiltro.add(ultimoPneu);
                    modeloTabela.addRow(new Object[]{
                        ultimoPneu.getId(),
                        ultimoPneu.getIdEmpresaProprietaria(),
                        ultimoPneu.getFogo(),
                        ultimoPneu.getFornecedor(),
                        ultimoPneu.getValor(),
                        ultimoPneu.getFabricante(),
                        ultimoPneu.getTipoPneu(),
                        ultimoPneu.getModelo(),
                        ultimoPneu.getDot(),
                        ultimoPneu.getMedida(),
                        ultimoPneu.getProfundidade(),
                        ultimoPneu.getDataCadastro(),
                        ultimoPneu.getnRecapagens(),
                        ultimoPneu.getProjetadoKm(),
                        ultimoPneu.getObservacoes()
                    });
                }
                formatarTabela();
                Tabela_Exibicao.clearSelection();
                
            } else {
                txtFogo.setText(""); 
                txtFogo.setEditable(true); 
                limparCampos(); 
                aplicarFiltroPneus(); 
            }
        });

        aplicarFiltroPneus();
        btnExcluir.setEnabled(false);
        CbMedida.setEnabled(false);
    }

    private void configurarBindingsEditor(JComboBox<?> comboBox,
            KeyStroke backspace,
            String backspaceActionKey,
            KeyStroke delete,
            String deleteActionKey) {

        Component editorComp = comboBox.getEditor().getEditorComponent();
        if (editorComp instanceof JTextComponent) {
            JTextComponent editor = (JTextComponent) editorComp;
            InputMap inputMap = editor.getInputMap(JComponent.WHEN_FOCUSED);

            inputMap.put(backspace, backspaceActionKey);
            inputMap.put(delete, deleteActionKey);

        } else {

            System.err.println("WARN: Editor de " + (comboBox.getName()
                    != null ? comboBox.getName() : "ComboBox sem nome")
                    + " não é JTextComponent, bindings não aplicados.");

            btnExcluir.setEnabled(false);

        }

        CbFornecedor.addItemListener(new ItemListener() {
            @Override
            public void itemStateChanged(ItemEvent e) {

                if (e.getStateChange() == ItemEvent.SELECTED) {

                    boolean habilitar = CbFornecedor.getSelectedIndex() > 0;
                    btnEditarFornecedor.setEnabled(habilitar);
                } else if (e.getStateChange() == ItemEvent.DESELECTED) {

                    btnEditarFornecedor.setEnabled(false);
                }
            }
        });

        btnEditarFornecedor.setEnabled(false);

        CbFabricante.addItemListener(new ItemListener() {
            @Override
            public void itemStateChanged(ItemEvent e) {
                if (e.getStateChange() == ItemEvent.SELECTED) {
                    boolean habilitar = CbFabricante.getSelectedIndex() > 0;
                    btnEditarFabricante.setEnabled(habilitar);
                } else if (e.getStateChange() == ItemEvent.DESELECTED) {
                    btnEditarFabricante.setEnabled(false);
                }
            }
        });

        btnEditarFabricante.setEnabled(false);

        CbModelo.addItemListener(new ItemListener() {
            @Override
            public void itemStateChanged(ItemEvent e) {
                if (e.getStateChange() == ItemEvent.SELECTED) {
                    boolean habilitar = CbModelo.getSelectedIndex() > 0;
                    btnEditarModelo.setEnabled(habilitar);
                } else if (e.getStateChange() == ItemEvent.DESELECTED) {
                    btnEditarModelo.setEnabled(false);
                }
            }
        });

        btnEditarModelo.setEnabled(false);

        CbMedida.addItemListener(new ItemListener() {
            @Override
            public void itemStateChanged(ItemEvent e) {

                if (e.getStateChange() == ItemEvent.SELECTED && CbMedida.isEnabled()) {
                    boolean habilitar = CbMedida.getSelectedIndex() > 0;
                    btnEditarMedida.setEnabled(habilitar);
                } else {

                    btnEditarMedida.setEnabled(false);
                }
            }
        });

        btnEditarMedida.setEnabled(false);
        CbMedida.setEnabled(false);

        CbTipoPneu.addItemListener(new ItemListener() {
            @Override
            public void itemStateChanged(ItemEvent e) {
                if (e.getStateChange() == ItemEvent.SELECTED) {
                    boolean habilitar = CbTipoPneu.getSelectedIndex() > 0;
                    btnEditarTipoPneu.setEnabled(habilitar);
                } else if (e.getStateChange() == ItemEvent.DESELECTED) {
                    btnEditarTipoPneu.setEnabled(false);
                }
            }
        });

        btnEditarTipoPneu.setEnabled(false);

    }

    private void popularComboBoxFornecedor() {
    fornecedorNomes.clear(); // Limpa antes de popular
    fornecedorNomes.addAll(fornecedorDAO.listarNomes()); // Armazena a lista completa

    CbFornecedor.removeAllItems();
    if (!fornecedorNomes.isEmpty()) {
        for (String nome : fornecedorNomes) {
            CbFornecedor.addItem(nome);
        }
        CbFornecedor.setSelectedIndex(-1);
    } else {
        CbFornecedor.setSelectedIndex(-1);
    }
}
private void popularComboBoxFabricante() {
    fabricanteNomes.clear(); // Limpa antes de popular
    fabricanteNomes.addAll(fabricanteDAO.listarNomes()); // Armazena a lista completa

    CbFabricante.removeAllItems();
    if (!fabricanteNomes.isEmpty()) {
        for (String nome : fabricanteNomes) {
            CbFabricante.addItem(nome);
        }
        CbFabricante.setSelectedIndex(-1);
    } else {
        CbFabricante.setSelectedIndex(-1);
    }
}

   private void popularComboBoxModelo() {
    modeloPneuNomes.clear(); // Limpa antes de popular
    modeloPneuNomes.addAll(modeloPneuDAO.listarNomes()); // Armazena a lista completa

    CbModelo.removeAllItems();
    if (!modeloPneuNomes.isEmpty()) {
        for (String nome : modeloPneuNomes) {
            CbModelo.addItem(nome);
        }
        CbModelo.setSelectedIndex(-1);
    } else {
        CbModelo.setSelectedIndex(-1);
    }
}

 private void popularComboBoxMedida(List<String> medidasPermitidas) {
    medidaPneuNomes.clear(); // Limpa antes de popular
    if (medidasPermitidas != null) {
        medidaPneuNomes.addAll(medidasPermitidas);
    }

    CbMedida.removeAllItems();
    if (medidasPermitidas != null && !medidasPermitidas.isEmpty()) {
        for (String medida : medidasPermitidas) {
            CbMedida.addItem(medida);
        }
    }
    CbMedida.setSelectedIndex(-1);
}

   private void popularComboBoxTipoPneu() {
    tipoPneuNomes.clear(); // Limpa antes de popular
    tipoPneuNomes.addAll(tipoPneuDAO.listarNomes()); // Armazena a lista completa

    CbTipoPneu.removeAllItems();
    if (tipoPneuNomes != null && !tipoPneuNomes.isEmpty()) {
        for (String nome : tipoPneuNomes) {
            CbTipoPneu.addItem(nome);
        }
        CbTipoPneu.setSelectedIndex(-1);
    } else {
        CbTipoPneu.setSelectedIndex(-1);
    }
}
   
  private void configurarCampoNumerico(JTextField campo) {
    campo.setHorizontalAlignment(SwingConstants.LEFT);
    
    // Adiciona um KeyListener para aceitar apenas números E LIMITAR A 5 CARACTERES
    campo.addKeyListener(new KeyAdapter() {
        @Override
        public void keyTyped(KeyEvent evt) {
            char c = evt.getKeyChar();
            // Bloqueia se não for número ou se já tiver 5 caracteres
            if (!Character.isDigit(c) && c != KeyEvent.VK_BACK_SPACE && c != KeyEvent.VK_DELETE) {
                evt.consume();
            } else if (Character.isDigit(c) && campo.getText().length() >= 5) {
                evt.consume(); // Bloqueia se já tiver 5 caracteres
            }
        }
    });
    
    // Adiciona um DocumentFilter para garantir que apenas números sejam inseridos
    if (campo.getDocument() instanceof AbstractDocument) {
        ((AbstractDocument) campo.getDocument()).setDocumentFilter(new DocumentFilter() {
            @Override
            public void insertString(FilterBypass fb, int offset, String string, AttributeSet attr)
                    throws BadLocationException {
                if (string.matches("d*")) {
                    super.insertString(fb, offset, string, attr);
                }
            }

            @Override
            public void replace(FilterBypass fb, int offset, int length, String text, AttributeSet attrs)
                    throws BadLocationException {
                if (text.matches("d*")) {
                    super.replace(fb, offset, length, text, attrs);
                }
            }
        });
    }
}
   
    private void formatarTabela() {
    // Define as larguras das colunas
    int[] larguras = {45, 60, 70, 150, 110, 120, 90, 100, 70, 110, 80, 90, 70, 90, 250};

    // Define as cores de fundo para cada coluna
    Color[] pneuTableColors = {
        TamanhoTabela.HEADER_COLORS[0], // ID - Rosa
        TamanhoTabela.HEADER_COLORS[1], // EMPR - Azul claro
        TamanhoTabela.HEADER_COLORS[2], // FOGO - Cáqui
        TamanhoTabela.HEADER_COLORS[3], // FORNECEDOR - Verde-claro
        TamanhoTabela.HEADER_COLORS[4], // VALOR - Pêssego
        TamanhoTabela.HEADER_COLORS[5], // FABRICANTE - Lavanda
        TamanhoTabela.HEADER_COLORS[6], // TIPO PNEU - Trigo
        TamanhoTabela.HEADER_COLORS[7], // MODELO - Azul acinzentado
        TamanhoTabela.HEADER_COLORS[8], // DOT - Orquídea
        TamanhoTabela.HEADER_COLORS[9], // MEDIDA - Salmão claro
        TamanhoTabela.HEADER_COLORS[0], // PROFUND. - Rosa (repetindo)
        TamanhoTabela.HEADER_COLORS[1], // DATA - Azul claro (repetindo)
        TamanhoTabela.HEADER_COLORS[2], // RECAP. - Cáqui (repetindo)
        Tabela_Exibicao.getBackground(), // PROJ. KM - Usa a cor de fundo da própria tabela para o PROJ. KM
        TamanhoTabela.HEADER_COLORS[4]  // OBS. - Pêssego (repetindo)
    };

    TamanhoTabela.configurar(Tabela_Exibicao, larguras, pneuTableColors);

    TamanhoTabela.CenterRenderer centerRenderer = new TamanhoTabela.CenterRenderer();
    TamanhoTabela.CurrencyRenderer currencyRenderer = new TamanhoTabela.CurrencyRenderer();
    TamanhoTabela.DateRenderer dateRenderer = new TamanhoTabela.DateRenderer();

    TableColumnModel columnModel = Tabela_Exibicao.getColumnModel();
    try {
        columnModel.getColumn(0).setCellRenderer(centerRenderer);
        columnModel.getColumn(1).setCellRenderer(centerRenderer);
        columnModel.getColumn(2).setCellRenderer(centerRenderer);
        columnModel.getColumn(4).setCellRenderer(currencyRenderer);
        columnModel.getColumn(8).setCellRenderer(centerRenderer);
        columnModel.getColumn(9).setCellRenderer(centerRenderer);
        columnModel.getColumn(10).setCellRenderer(centerRenderer);
        columnModel.getColumn(11).setCellRenderer(dateRenderer);
        columnModel.getColumn(12).setCellRenderer(centerRenderer);
        columnModel.getColumn(13).setCellRenderer(centerRenderer);
    } catch (ArrayIndexOutOfBoundsException e) {
        System.err.println("Erro ao configurar colunas da tabela: " + e.getMessage());
    }

    // --- O RowSorter é criado e definido centralmente ---
    System.out.println("DEBUG: TableRowSorter gerenciado centralmente.");

    final JTableHeader header = Tabela_Exibicao.getTableHeader();
    
    // O código que removia os listeners de mouse foi retirado para evitar conflitos.
    
    // Se você tinha um MouseListener para clique duplo de redimensionamento, ele também precisa ser removido.
    // Como você o adicionou diretamente no formatarTabela(), ele será sobrescrito ou não adicionado novamente
    // se não o incluirmos aqui. O MouseListener padrão do JTable já lida com a ordenação.
    // ----------------------------------------------------------------------
    
    // --- Configuração do Renderizador de Cabeçalho com as setas ---
    // header.setDefaultRenderer(new SortHeaderRenderer(pneuTableColors, Tabela_Exibicao.getBackground()));
    System.out.println("DEBUG: SortHeaderRenderer definido para Tabela_Exibicao.");
}

    private void aplicarFiltroPneus() {
    DefaultTableModel modeloTabela = (DefaultTableModel) Tabela_Exibicao.getModel();
    modeloTabela.setNumRows(0);
    pneusExibidosNoFiltro.clear();

    List<Integer> idsEmpresasSelecionadas = new ArrayList<>();
    if (MARTINS_BORGES.isSelected()) {
        idsEmpresasSelecionadas.add(ID_EMPRESA_MARTINS_BORGES);
    }
    if (ALB.isSelected()) {
        idsEmpresasSelecionadas.add(ID_EMPRESA_ALB);
    }
    if (ENGEUDI.isSelected()) {
        idsEmpresasSelecionadas.add(ID_EMPRESA_ENGEUDI);
    }

    String fogoDigitado = txtFogo.getText().trim();

    if (idsEmpresasSelecionadas.isEmpty() && fogoDigitado.isEmpty()) {
        pneusExibidosNoFiltro.addAll(pneuDAO.listarTodosPneus());
    } else {
        pneusExibidosNoFiltro.addAll(pneuDAO.buscarPorEmpresasEFogo(idsEmpresasSelecionadas, fogoDigitado));
    }

    for (Pneu p : pneusExibidosNoFiltro) {
        modeloTabela.addRow(new Object[]{
            p.getId(),
            p.getIdEmpresaProprietaria(),
            p.getFogo(),
            p.getFornecedor(),
            p.getValor(),
            p.getFabricante(),
            p.getTipoPneu(),
            p.getModelo(),
            p.getDot(),
            p.getMedida(),
            p.getProfundidade(),
            p.getDataCadastro(),
            p.getnRecapagens(),
            p.getProjetadoKm(),
            p.getObservacoes()
        });
    }

    formatarTabela();
    Tabela_Exibicao.clearSelection();
}

    private void limparCampos() {
        if (grupoEmpresas != null) {
            grupoEmpresas.clearSelection();
        }
        txtFogo.setText("");
        TxtDot.setText("");
        TxtProfud.setText("");
        TxtRecap.setText("");
        TxtProjecao.setText("");
        TxtObs.setText("");
        TxtValor.setText("");

        CbFornecedor.setSelectedIndex(-1);
        CbFabricante.setSelectedIndex(-1);
        CbTipoPneu.setSelectedIndex(-1);
        CbModelo.setSelectedIndex(-1);
        CbMedida.setSelectedIndex(-1);

        modoEdicao = false;
        idPneuEmEdicao = -1;
        atualizarEstadoBotoes();
        Tabela_Exibicao.clearSelection();
    }
    
    private void limparCamposParaNovoCadastro() {
        txtFogo.setText("");
        TxtDot.setText("");
        TxtProfud.setText("");
        TxtRecap.setText("");
        TxtProjecao.setText("");
        TxtObs.setText("");
        TxtValor.setText("");

        CbFornecedor.setSelectedIndex(-1);
        CbFabricante.setSelectedIndex(-1);
        CbTipoPneu.setSelectedIndex(-1);
        CbModelo.setSelectedIndex(-1);
        CbMedida.setSelectedIndex(-1);

        modoEdicao = false;
        idPneuEmEdicao = -1;
        atualizarEstadoBotoes();
        Tabela_Exibicao.clearSelection();
    }

    private void carregarDadosParaEdicao(int linhaSelecionadaNaView) {
        try {
            DefaultTableModel modeloTabela = (DefaultTableModel) Tabela_Exibicao.getModel();
            int linhaModelo = Tabela_Exibicao.convertRowIndexToModel(linhaSelecionadaNaView);
            int id = (Integer) modeloTabela.getValueAt(linhaModelo, 0);
            this.idPneuEmEdicao = id;

            int idEmpresa = (Integer) modeloTabela.getValueAt(linhaModelo, 1);
            String fogo = modeloTabela.getValueAt(linhaModelo, 2).toString();
            String fornecedor = (String) modeloTabela.getValueAt(linhaModelo, 3);
            Double valor = null;
            Object valorObj = modeloTabela.getValueAt(linhaModelo, 4);
            if (valorObj instanceof Number) {
                valor = ((Number) valorObj).doubleValue();
            } else if (valorObj != null) {
                try {
                    Number vn = currencyFormat.parse(valorObj.toString());
                    valor = vn.doubleValue();
                } catch (ParseException pe) {
                    System.err.println("WARN: Parse VALOR tabela:" + valorObj);
                    valor = 0.0;
                }
            }
            String fabricante = (String) modeloTabela.getValueAt(linhaModelo, 5);
            String tipoPneu = (String) modeloTabela.getValueAt(linhaModelo, 6);
            String modelo = (String) modeloTabela.getValueAt(linhaModelo, 7);
            String dot = (String) modeloTabela.getValueAt(linhaModelo, 8);
            String medida = (String) modeloTabela.getValueAt(linhaModelo, 9);
            Double profundidade = null;
            Object profObj = modeloTabela.getValueAt(linhaModelo, 10);
            if (profObj instanceof Number) {
                profundidade = ((Number) profObj).doubleValue();
            } else if (profObj != null) {
                try {
                    profundidade = Double.valueOf(profObj.toString().replace(",", "."));
                } catch (NumberFormatException nfe) {
                    System.err.println("WARN: Parse PROF tabela:" + profObj);
                }
            }
            Integer nRecapagens = 0;
            Object recapObj = modeloTabela.getValueAt(linhaModelo, 12);
            if (recapObj instanceof Number) {
                nRecapagens = ((Number) recapObj).intValue();
            } else if (recapObj != null) {
                try {
                    nRecapagens = Integer.valueOf(recapObj.toString());
                } catch (NumberFormatException nfe) {
                    System.err.println("WARN: Parse RECAP tabela:" + recapObj);
                }
            }
            Integer projecaoKm = null;
            Object projObj = modeloTabela.getValueAt(linhaModelo, 13);
            if (projObj instanceof Number) {
                projecaoKm = ((Number) projObj).intValue();
            } else if (projObj != null) {
                try {
                    projecaoKm = Integer.valueOf(projObj.toString());
                } catch (NumberFormatException nfe) {
                    System.err.println("WARN: Parse PROJ KM tabela:" + projObj);
                }
            }
            String obs = "";
            Object obsObj = modeloTabela.getValueAt(linhaModelo, 14);
            if (obsObj != null) {
                obs = obsObj.toString();
            }

            grupoEmpresas.clearSelection();
            switch (idEmpresa) {

                case ID_EMPRESA_MARTINS_BORGES:
                    MARTINS_BORGES.setSelected(true);
                    break;
                case ID_EMPRESA_ALB:
                    ALB.setSelected(true);
                    break;
                case ID_EMPRESA_ENGEUDI:
                    ENGEUDI.setSelected(true);
                    break;
                default:
                    break;
            }

            atualizarOpcoesMedida();

            txtFogo.setText(fogo);
            selecionarItemComboBox(CbFornecedor, fornecedor);
            selecionarItemComboBox(CbFabricante, fabricante);
            selecionarItemComboBox(CbModelo, modelo);
            selecionarItemComboBox(CbMedida, medida);
            selecionarItemComboBox(CbTipoPneu, tipoPneu);

            if (TxtValor != null) {
                TxtValor.setText(valor != null ? currencyFormat.format(valor) : "");
            }
            TxtDot.setText(dot != null ? dot : "");
            TxtProfud.setText(profundidade != null ? String.format(Locale.GERMAN, "%.1f", profundidade) : "");
            TxtRecap.setText(nRecapagens != null ? String.valueOf(nRecapagens) : "0");
            TxtProjecao.setText(projecaoKm != null ? String.valueOf(projecaoKm) : "");
            TxtObs.setText(obs != null ? obs : "");

            modoEdicao = true;
            atualizarEstadoBotoes();

        } catch (ClassCastException cce) {
            JOptionPane.showMessageDialog(this, "Erro ao converter tipo de dado da tabela para edição.nVerifique se os dados na tabela estão corretos.n" + cce.getMessage(), "Erro de Tipo", JOptionPane.ERROR_MESSAGE);
            cancelarEdicao();
        } catch (Exception e) {
            JOptionPane.showMessageDialog(this, "Erro inesperado ao carregar dados para edição:n" + e.getMessage(), "Erro", JOptionPane.ERROR_MESSAGE);
            e.printStackTrace();
            cancelarEdicao();
        }
    }

    private void selecionarItemComboBox(JComboBox<String> comboBox, String itemParaSelecionar) {
        if (itemParaSelecionar == null) {
            comboBox.setSelectedIndex(-1);
            return;
        }
        DefaultComboBoxModel<String> model = (DefaultComboBoxModel<String>) comboBox.getModel();
        boolean encontrado = false;
        for (int i = 0; i < model.getSize(); i++) {
            if (itemParaSelecionar.equalsIgnoreCase(model.getElementAt(i))) {
                comboBox.setSelectedIndex(i);
                encontrado = true;
                break;
            }
        }

        if (!encontrado && comboBox.isEditable()) {
            comboBox.setSelectedItem(itemParaSelecionar);
        } else if (!encontrado) {
            comboBox.setSelectedIndex(-1);
        }

    }

    private void atualizarEstadoBotoes() {

        if (modoEdicao) {
            btnCadastrar.setText("SALVAR ALTERAÇÕES");

            btnExcluir.setEnabled(true);
        } else {
            btnCadastrar.setText("CADASTRAR");

            btnExcluir.setEnabled(Tabela_Exibicao.getSelectedRow() != -1);
        }

    }

    private void cancelarEdicao() {
        modoEdicao = false;
        idPneuEmEdicao = -1;
        limparCampos();
        Tabela_Exibicao.clearSelection();

        aplicarFiltroPneus();
    }

    private void prepararParaDuplicacao() {
        this.modoEdicao = false;
        this.idPneuEmEdicao = -1;
        
        txtFogo.setText(""); 
        atualizarEstadoBotoes(); 
        Tabela_Exibicao.clearSelection(); 
        txtFogo.requestFocusInWindow(); 
    }

    private void sugerirProximoFogo() {
        if (!Novo.isSelected()) {
            return;
        }

        int idEmpresa = 0;
        if (MARTINS_BORGES.isSelected()) {
            idEmpresa = ID_EMPRESA_MARTINS_BORGES;
        } else if (ALB.isSelected()) {
            idEmpresa = ID_EMPRESA_ALB;
        } else if (ENGEUDI.isSelected()) {
            idEmpresa = ID_EMPRESA_ENGEUDI;
        }

        if (idEmpresa > 0) {
            int ultimoFogo = pneuDAO.obterUltimoFogoPorEmpresa(idEmpresa);
            txtFogo.setText(String.valueOf(ultimoFogo + 1));
        } else {
            txtFogo.setText("");
        }
    }

    private void atualizarTabelaDados() {
        aplicarFiltroPneus();
    }

 
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {
        java.awt.GridBagConstraints gridBagConstraints;

        btnCadastrar = new javax.swing.JButton();
        btnExcluir = new javax.swing.JButton();
        jCadastro1 = new javax.swing.JPanel();
        lbValor = new javax.swing.JLabel();
        lbTipo_pneu = new javax.swing.JLabel();
        CbTipoPneu = new javax.swing.JComboBox<>();
        lbProfundidade = new javax.swing.JLabel();
        TxtProfud = new javax.swing.JTextField();
        lbRecap = new javax.swing.JLabel();
        TxtRecap = new javax.swing.JTextField();
        btnNovoTipoPneu = new javax.swing.JButton();
        lbProjecao = new javax.swing.JLabel();
        TxtProjecao = new javax.swing.JTextField();
        TxtValor = new javax.swing.JTextField();
        btnEditarTipoPneu = new javax.swing.JButton();
        jCadastro2 = new javax.swing.JPanel();
        lb_Fornecedor = new javax.swing.JLabel();
        CbFornecedor = new javax.swing.JComboBox<>();
        btnNovoFornecedor = new javax.swing.JButton();
        lbFabricante = new javax.swing.JLabel();
        CbFabricante = new javax.swing.JComboBox<>();
        btnNovoFabricante = new javax.swing.JButton();
        lbModelo = new javax.swing.JLabel();
        CbModelo = new javax.swing.JComboBox<>();
        btnNovoModelo = new javax.swing.JButton();
        lbMedida = new javax.swing.JLabel();
        CbMedida = new javax.swing.JComboBox<>();
        btnNovoMedida = new javax.swing.JButton();
        lbObs = new javax.swing.JLabel();
        TxtObs = new javax.swing.JTextField();
        lbDot = new javax.swing.JLabel();
        TxtDot = new javax.swing.JTextField();
        btnEditarMedida = new javax.swing.JButton();
        btnEditarFornecedor = new javax.swing.JButton();
        btnEditarModelo = new javax.swing.JButton();
        btnEditarFabricante = new javax.swing.JButton();
        jScrollPane = new javax.swing.JScrollPane();
        Tabela_Exibicao = new javax.swing.JTable();
        Empresas = new javax.swing.JPanel();
        MARTINS_BORGES = new javax.swing.JCheckBox();
        ALB = new javax.swing.JCheckBox();
        ENGEUDI = new javax.swing.JCheckBox();
        txtFogo = new javax.swing.JTextField();
        lbFogo = new javax.swing.JLabel();
        Novo = new javax.swing.JCheckBox();

        setDefaultCloseOperation(javax.swing.WindowConstants.DISPOSE_ON_CLOSE);
        setMinimumSize(new java.awt.Dimension(1250, 670));
        setName("TelaCadastroPneus"); // NOI18N

        btnCadastrar.setText("CADASTRAR");
        btnCadastrar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnCadastrarActionPerformed(evt);
            }
        });

        btnExcluir.setText("EXCLUIR");
        btnExcluir.setToolTipText("Excluir pneu selecionado");
        btnExcluir.setEnabled(false);
        btnExcluir.setName("btnExcluir"); // NOI18N
        btnExcluir.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnExcluirActionPerformed(evt);
            }
        });

        lbValor.setText("Valor");

        lbTipo_pneu.setText("Tipo Pneu");

        lbProfundidade.setText("Profundidade (mm): ");

        lbRecap.setText("N° Recap.: ");

        TxtRecap.setName(""); // NOI18N

        btnNovoTipoPneu.setIcon(new javax.swing.ImageIcon(getClass().getResource("/br/com/Martins_Borges/telas/Imagens/+.png"))); // NOI18N
        btnNovoTipoPneu.setToolTipText("Adicionar novo tipo de Pneu");
        btnNovoTipoPneu.setMaximumSize(new java.awt.Dimension(25, 25));
        btnNovoTipoPneu.setMinimumSize(new java.awt.Dimension(25, 25));
        btnNovoTipoPneu.setPreferredSize(new java.awt.Dimension(25, 25));
        btnNovoTipoPneu.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnNovoTipoPneuActionPerformed(evt);
            }
        });

        lbProjecao.setText("Projeção km: ");

        TxtValor.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
        TxtValor.setMinimumSize(new java.awt.Dimension(72, 22));
        TxtValor.setPreferredSize(new java.awt.Dimension(72, 22));

        btnEditarTipoPneu.setIcon(new javax.swing.ImageIcon(getClass().getResource("/br/com/Martins_Borges/telas/Imagens/pencil.png"))); // NOI18N
        btnEditarTipoPneu.setMaximumSize(new java.awt.Dimension(25, 25));
        btnEditarTipoPneu.setMinimumSize(new java.awt.Dimension(25, 25));
        btnEditarTipoPneu.setName("btnEditarTipoPneu"); // NOI18N
        btnEditarTipoPneu.setPreferredSize(new java.awt.Dimension(25, 25));
        btnEditarTipoPneu.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnEditarTipoPneuActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jCadastro1Layout = new javax.swing.GroupLayout(jCadastro1);
        jCadastro1.setLayout(jCadastro1Layout);
        jCadastro1Layout.setHorizontalGroup(
            jCadastro1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jCadastro1Layout.createSequentialGroup()
                .addGap(4, 4, 4)
                .addGroup(jCadastro1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(lbValor)
                    .addComponent(lbRecap)
                    .addComponent(lbProjecao)
                    .addGroup(jCadastro1Layout.createSequentialGroup()
                        .addGroup(jCadastro1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(CbTipoPneu, javax.swing.GroupLayout.PREFERRED_SIZE, 130, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(TxtProfud, javax.swing.GroupLayout.PREFERRED_SIZE, 90, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(TxtRecap, javax.swing.GroupLayout.PREFERRED_SIZE, 90, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(TxtProjecao, javax.swing.GroupLayout.PREFERRED_SIZE, 90, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGap(6, 6, 6)
                        .addComponent(btnNovoTipoPneu, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(btnEditarTipoPneu, javax.swing.GroupLayout.PREFERRED_SIZE, 27, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addComponent(lbProfundidade)
                    .addComponent(lbTipo_pneu, javax.swing.GroupLayout.PREFERRED_SIZE, 72, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(TxtValor, javax.swing.GroupLayout.PREFERRED_SIZE, 100, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap(18, Short.MAX_VALUE))
        );
        jCadastro1Layout.setVerticalGroup(
            jCadastro1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jCadastro1Layout.createSequentialGroup()
                .addGap(6, 6, 6)
                .addComponent(lbValor)
                .addGap(8, 8, 8)
                .addComponent(TxtValor, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(4, 4, 4)
                .addComponent(lbTipo_pneu)
                .addGap(4, 4, 4)
                .addGroup(jCadastro1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jCadastro1Layout.createSequentialGroup()
                        .addGap(1, 1, 1)
                        .addComponent(CbTipoPneu, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addComponent(btnNovoTipoPneu, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(btnEditarTipoPneu, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(14, 14, 14)
                .addComponent(lbProfundidade)
                .addGap(4, 4, 4)
                .addComponent(TxtProfud, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(8, 8, 8)
                .addComponent(lbRecap)
                .addGap(4, 4, 4)
                .addComponent(TxtRecap, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(18, 18, 18)
                .addComponent(lbProjecao)
                .addGap(4, 4, 4)
                .addComponent(TxtProjecao, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
        );

        lb_Fornecedor.setText("Fornecedor: ");

        btnNovoFornecedor.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        btnNovoFornecedor.setForeground(new java.awt.Color(255, 0, 0));
        btnNovoFornecedor.setIcon(new javax.swing.ImageIcon(getClass().getResource("/br/com/Martins_Borges/telas/Imagens/+.png"))); // NOI18N
        btnNovoFornecedor.setToolTipText("Adicionar novo fornecedor");
        btnNovoFornecedor.setMaximumSize(new java.awt.Dimension(25, 25));
        btnNovoFornecedor.setMinimumSize(new java.awt.Dimension(25, 25));
        btnNovoFornecedor.setPreferredSize(new java.awt.Dimension(25, 25));
        btnNovoFornecedor.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnNovoFornecedorActionPerformed(evt);
            }
        });

        lbFabricante.setText("Fabricante:");

        btnNovoFabricante.setFont(new java.awt.Font("Agency FB", 1, 14)); // NOI18N
        btnNovoFabricante.setForeground(new java.awt.Color(255, 51, 51));
        btnNovoFabricante.setIcon(new javax.swing.ImageIcon(getClass().getResource("/br/com/Martins_Borges/telas/Imagens/+.png"))); // NOI18N
        btnNovoFabricante.setToolTipText("Adicionar novo Fabricante");
        btnNovoFabricante.setMaximumSize(new java.awt.Dimension(25, 25));
        btnNovoFabricante.setMinimumSize(new java.awt.Dimension(25, 25));
        btnNovoFabricante.setPreferredSize(new java.awt.Dimension(25, 25));
        btnNovoFabricante.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnNovoFabricanteActionPerformed(evt);
            }
        });

        lbModelo.setText("Modelo:");

        btnNovoModelo.setFont(new java.awt.Font("Agency FB", 1, 14)); // NOI18N
        btnNovoModelo.setForeground(new java.awt.Color(255, 51, 51));
        btnNovoModelo.setIcon(new javax.swing.ImageIcon(getClass().getResource("/br/com/Martins_Borges/telas/Imagens/+.png"))); // NOI18N
        btnNovoModelo.setToolTipText("Adicionar novo modelo");
        btnNovoModelo.setMaximumSize(new java.awt.Dimension(25, 25));
        btnNovoModelo.setMinimumSize(new java.awt.Dimension(25, 25));
        btnNovoModelo.setName(" btnNovoModelo"); // NOI18N
        btnNovoModelo.setPreferredSize(new java.awt.Dimension(25, 25));
        btnNovoModelo.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnNovoModeloActionPerformed(evt);
            }
        });

        lbMedida.setText("Medida:");

        CbMedida.setEnabled(false);

        btnNovoMedida.setFont(new java.awt.Font("Agency FB", 1, 14)); // NOI18N
        btnNovoMedida.setForeground(new java.awt.Color(255, 51, 51));
        btnNovoMedida.setIcon(new javax.swing.ImageIcon(getClass().getResource("/br/com/Martins_Borges/telas/Imagens/+.png"))); // NOI18N
        btnNovoMedida.setToolTipText("Adicionar nova medida");
        btnNovoMedida.setMaximumSize(new java.awt.Dimension(25, 25));
        btnNovoMedida.setMinimumSize(new java.awt.Dimension(25, 25));
        btnNovoMedida.setPreferredSize(new java.awt.Dimension(25, 25));
        btnNovoMedida.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnNovoMedidaActionPerformed(evt);
            }
        });

        lbObs.setText("OBS.:");

        lbDot.setText("Dot: ");

        btnEditarMedida.setIcon(new javax.swing.ImageIcon(getClass().getResource("/br/com/Martins_Borges/telas/Imagens/pencil.png"))); // NOI18N
        btnEditarMedida.setMaximumSize(new java.awt.Dimension(25, 25));
        btnEditarMedida.setMinimumSize(new java.awt.Dimension(25, 25));
        btnEditarMedida.setName("btnEditarMedida"); // NOI18N
        btnEditarMedida.setPreferredSize(new java.awt.Dimension(25, 25));
        btnEditarMedida.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnEditarMedidaActionPerformed(evt);
            }
        });

        btnEditarFornecedor.setIcon(new javax.swing.ImageIcon(getClass().getResource("/br/com/Martins_Borges/telas/Imagens/pencil.png"))); // NOI18N
        btnEditarFornecedor.setToolTipText("Editar fornecedor selecionado");
        btnEditarFornecedor.setMaximumSize(new java.awt.Dimension(25, 25));
        btnEditarFornecedor.setMinimumSize(new java.awt.Dimension(25, 25));
        btnEditarFornecedor.setName("btnEditarFornecedor"); // NOI18N
        btnEditarFornecedor.setPreferredSize(new java.awt.Dimension(25, 25));
        btnEditarFornecedor.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnEditarFornecedorActionPerformed(evt);
            }
        });

        btnEditarModelo.setIcon(new javax.swing.ImageIcon(getClass().getResource("/br/com/Martins_Borges/telas/Imagens/pencil.png"))); // NOI18N
        btnEditarModelo.setMaximumSize(new java.awt.Dimension(25, 25));
        btnEditarModelo.setMinimumSize(new java.awt.Dimension(25, 25));
        btnEditarModelo.setName("btnEditarModelo"); // NOI18N
        btnEditarModelo.setPreferredSize(new java.awt.Dimension(25, 25));
        btnEditarModelo.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnEditarModeloActionPerformed(evt);
            }
        });

        btnEditarFabricante.setIcon(new javax.swing.ImageIcon(getClass().getResource("/br/com/Martins_Borges/telas/Imagens/pencil.png"))); // NOI18N
        btnEditarFabricante.setMaximumSize(new java.awt.Dimension(25, 25));
        btnEditarFabricante.setMinimumSize(new java.awt.Dimension(25, 25));
        btnEditarFabricante.setName("btnEditarFabricante"); // NOI18N
        btnEditarFabricante.setPreferredSize(new java.awt.Dimension(25, 25));
        btnEditarFabricante.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnEditarFabricanteActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jCadastro2Layout = new javax.swing.GroupLayout(jCadastro2);
        jCadastro2.setLayout(jCadastro2Layout);
        jCadastro2Layout.setHorizontalGroup(
            jCadastro2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jCadastro2Layout.createSequentialGroup()
                .addGap(24, 24, 24)
                .addGroup(jCadastro2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jCadastro2Layout.createSequentialGroup()
                        .addGroup(jCadastro2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(lb_Fornecedor, javax.swing.GroupLayout.PREFERRED_SIZE, 78, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(CbFornecedor, javax.swing.GroupLayout.PREFERRED_SIZE, 270, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(lbFabricante, javax.swing.GroupLayout.PREFERRED_SIZE, 70, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(CbFabricante, javax.swing.GroupLayout.PREFERRED_SIZE, 270, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(lbModelo)
                            .addComponent(lbMedida, javax.swing.GroupLayout.PREFERRED_SIZE, 50, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(lbDot)
                            .addComponent(TxtDot, javax.swing.GroupLayout.PREFERRED_SIZE, 90, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGap(6, 6, 6)
                        .addGroup(jCadastro2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(jCadastro2Layout.createSequentialGroup()
                                .addComponent(btnNovoFornecedor, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(btnEditarFornecedor, javax.swing.GroupLayout.PREFERRED_SIZE, 27, javax.swing.GroupLayout.PREFERRED_SIZE))
                            .addGroup(jCadastro2Layout.createSequentialGroup()
                                .addComponent(btnNovoFabricante, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(btnEditarFabricante, javax.swing.GroupLayout.PREFERRED_SIZE, 27, javax.swing.GroupLayout.PREFERRED_SIZE))))
                    .addComponent(TxtObs, javax.swing.GroupLayout.PREFERRED_SIZE, 380, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(lbObs, javax.swing.GroupLayout.PREFERRED_SIZE, 37, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addGroup(jCadastro2Layout.createSequentialGroup()
                        .addComponent(CbMedida, javax.swing.GroupLayout.PREFERRED_SIZE, 180, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(btnNovoMedida, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(btnEditarMedida, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(jCadastro2Layout.createSequentialGroup()
                        .addComponent(CbModelo, javax.swing.GroupLayout.PREFERRED_SIZE, 180, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(btnNovoModelo, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(btnEditarModelo, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))))
        );
        jCadastro2Layout.setVerticalGroup(
            jCadastro2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jCadastro2Layout.createSequentialGroup()
                .addGap(6, 6, 6)
                .addComponent(lb_Fornecedor)
                .addGap(4, 4, 4)
                .addGroup(jCadastro2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.CENTER)
                    .addComponent(btnNovoFornecedor, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(btnEditarFornecedor, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(6, 6, 6)
                .addComponent(lbFabricante)
                .addGap(4, 4, 4)
                .addGroup(jCadastro2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jCadastro2Layout.createSequentialGroup()
                        .addGroup(jCadastro2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(jCadastro2Layout.createSequentialGroup()
                                .addGap(1, 1, 1)
                                .addComponent(CbFabricante, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                            .addComponent(btnNovoFabricante, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGap(1, 1, 1)
                        .addComponent(lbModelo))
                    .addComponent(btnEditarFabricante, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(6, 6, 6)
                .addGroup(jCadastro2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(CbModelo, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(btnNovoModelo, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(btnEditarModelo, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(7, 7, 7)
                .addComponent(lbMedida)
                .addGap(4, 4, 4)
                .addGroup(jCadastro2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(CbMedida, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(btnNovoMedida, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(btnEditarMedida, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(6, 6, 6)
                .addComponent(lbDot)
                .addGap(0, 0, 0)
                .addComponent(TxtDot, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(25, 25, 25)
                .addComponent(lbObs)
                .addGap(4, 4, 4)
                .addComponent(TxtObs, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
            .addGroup(jCadastro2Layout.createSequentialGroup()
                .addGap(29, 29, 29)
                .addComponent(CbFornecedor, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
        );

        jScrollPane.setBorder(javax.swing.BorderFactory.createBevelBorder(javax.swing.border.BevelBorder.RAISED));
        jScrollPane.setFont(new java.awt.Font("Segoe UI", 1, 12)); // NOI18N
        jScrollPane.setPreferredSize(new java.awt.Dimension(1000, 300));
        jScrollPane.setViewportBorder(javax.swing.BorderFactory.createEmptyBorder(5, 5, 5, 5));
        jScrollPane.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                jScrollPaneMouseClicked(evt);
            }
        });

        Tabela_Exibicao.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null, null, null}
            },
            new String [] {
                "ID", "EMPR.", "FOGO", "FORNECEDOR", "VALOR", "FABRICANTE", "TIPO PNEU", "MODELO", "DOT", "MEDIDA", "PROFUND", "DATA", "RECAP.", "PROJ. KM", "OBS.:"
            }
        ) {
            boolean[] canEdit = new boolean [] {
                false, true, true, true, true, true, true, true, true, true, true, true, true, true, true
            };

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        
        // Configuração do redimensionamento das colunas
        Tabela_Exibicao.setAutoResizeMode(javax.swing.JTable.AUTO_RESIZE_LAST_COLUMN);
        
        // Criar um renderizador centralizado para as células
        javax.swing.table.DefaultTableCellRenderer centerRenderer = new javax.swing.table.DefaultTableCellRenderer();
        centerRenderer.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        
        // Ajusta o tamanho preferencial das colunas e aplica o renderizador centralizado
        javax.swing.table.TableColumnModel columnModel = Tabela_Exibicao.getColumnModel();
        
        // Configuração das colunas com larguras e alinhamento
        String[] columnNames = {
            "ID", "EMPR.", "FOGO", "FORNECEDOR", "VALOR", 
            "FABRICANTE", "TIPO PNEU", "MODELO", "DOT", "MEDIDA", 
            "PROFUND", "DATA", "RECAP.", "PROJ. KM", "OBS."
        };
        
        int[] columnWidths = {
            40,   // ID
            60,   // EMPR.
            60,   // FOGO
            150,  // FORNECEDOR
            80,   // VALOR
            120,  // FABRICANTE
            100,  // TIPO PNEU
            100,  // MODELO
            80,   // DOT
            80,   // MEDIDA
            70,   // PROFUND
            80,   // DATA
            60,   // RECAP.
            80,   // PROJ. KM
            200   // OBS.
        };
        
        // Aplicar configurações para cada coluna
        for (int i = 0; i < columnNames.length; i++) {
            javax.swing.table.TableColumn column = columnModel.getColumn(i);
            column.setPreferredWidth(columnWidths[i]);
            
            // Aplicar renderizador centralizado para todas as colunas
            column.setCellRenderer(centerRenderer);
            
            // Permitir redimensionamento da coluna
            column.setResizable(true);
        }
        
        // Configuração da tabela
        // O sorter é gerenciado centralmente agora
        Tabela_Exibicao.setFillsViewportHeight(true);
        Tabela_Exibicao.setShowVerticalLines(true);
        Tabela_Exibicao.setSelectionMode(javax.swing.ListSelectionModel.SINGLE_SELECTION);
        
        // O sorter agora é configurado no método configuracoesIniciais()
        
        // Permitir redimensionamento de colunas arrastando as bordas
        Tabela_Exibicao.getTableHeader().setReorderingAllowed(false);
        Tabela_Exibicao.setAutoResizeMode(javax.swing.JTable.AUTO_RESIZE_LAST_COLUMN);
        
        // Configuração básica da tabela
        Tabela_Exibicao.setAutoResizeMode(javax.swing.JTable.AUTO_RESIZE_LAST_COLUMN);
        Tabela_Exibicao.getTableHeader().setReorderingAllowed(false);
        
        // Configura o redimensionamento de colunas
        Tabela_Exibicao.getTableHeader().setResizingAllowed(true);
        
        // Configura o sorter para mostrar os indicadores de ordenação
        Tabela_Exibicao.setAutoCreateRowSorter(true);
        
        // Obtém o cabeçalho da tabela
        final javax.swing.table.JTableHeader header = Tabela_Exibicao.getTableHeader();
        
                // Listener para configurar o cursor e gerenciar a capacidade de ordenação
        header.addMouseMotionListener(new java.awt.event.MouseMotionAdapter() {
            private boolean isSortable = true;

            @Override
            public void mouseMoved(java.awt.event.MouseEvent e) {
                int column = header.columnAtPoint(e.getPoint());
                if (column < 0) return;
                
                int x = e.getX();
                int colX = 0;
                for (int i = 0; i < column; i++) {
                    colX += Tabela_Exibicao.getColumnModel().getColumn(i).getWidth();
                }
                int colWidth = Tabela_Exibicao.getColumnModel().getColumn(column).getWidth();
                
                boolean onDivider = Math.abs((colX + colWidth) - x) <= 3;

                if (onDivider) {
                    header.setCursor(java.awt.Cursor.getPredefinedCursor(java.awt.Cursor.E_RESIZE_CURSOR));
                    if (isSortable && sorter != null) {
                        for (int i = 0; i < Tabela_Exibicao.getColumnCount(); i++) {
                            sorter.setSortable(i, false);
                        }
                        isSortable = false;
                    }
                } else {
                    header.setCursor(java.awt.Cursor.getDefaultCursor());
                    if (!isSortable && sorter != null) {
                        for (int i = 0; i < Tabela_Exibicao.getColumnCount(); i++) {
                            sorter.setSortable(i, true);
                        }
                        isSortable = true;
                    }
                }
            }
        });

        // Listener para o clique duplo de redimensionamento
        header.addMouseListener(new java.awt.event.MouseAdapter() {
            @Override
            public void mouseClicked(java.awt.event.MouseEvent e) {
                if (e.getClickCount() == 2 && header.getCursor().getType() == java.awt.Cursor.E_RESIZE_CURSOR) {
                    int column = header.columnAtPoint(e.getPoint());
                    if (column >= 0) {
                        // Lógica para auto-ajustar a largura
                        javax.swing.table.TableColumn tableColumn = Tabela_Exibicao.getColumnModel().getColumn(column);
                        int width = 0;
                        java.awt.Component comp = header.getDefaultRenderer().getTableCellRendererComponent(Tabela_Exibicao, tableColumn.getHeaderValue(), false, false, -1, column);
                        width = Math.max(width, comp.getPreferredSize().width);

                        for (int row = 0; row < Tabela_Exibicao.getRowCount(); row++) {
                            java.awt.Component cell = Tabela_Exibicao.prepareRenderer(Tabela_Exibicao.getCellRenderer(row, column), row, column);
                            width = Math.max(width, cell.getPreferredSize().width);
                        }
                        
                        width += Tabela_Exibicao.getIntercellSpacing().width * 2;
                        tableColumn.setPreferredWidth(width);
                        Tabela_Exibicao.repaint();
                        e.consume();
                    }
                }
            }
        });
        Tabela_Exibicao.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                Tabela_ExibicaoMouseClicked(evt);
            }
        });
        jScrollPane.setViewportView(Tabela_Exibicao);

        Empresas.setPreferredSize(new java.awt.Dimension(145, 145));
        Empresas.setLayout(new java.awt.GridBagLayout());

        MARTINS_BORGES.setText("MARTINS E BORGES");
        MARTINS_BORGES.setMaximumSize(new java.awt.Dimension(150, 20));
        MARTINS_BORGES.setMinimumSize(new java.awt.Dimension(150, 20));
        MARTINS_BORGES.setPreferredSize(new java.awt.Dimension(150, 20));
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.gridwidth = 4;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.insets = new java.awt.Insets(6, 0, 0, 2);
        Empresas.add(MARTINS_BORGES, gridBagConstraints);

        ALB.setText("ALB");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.insets = new java.awt.Insets(6, 0, 0, 0);
        Empresas.add(ALB, gridBagConstraints);

        ENGEUDI.setText("ENGEUDI");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 2;
        gridBagConstraints.gridwidth = 2;
        gridBagConstraints.ipady = 9;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.insets = new java.awt.Insets(6, 0, 0, 0);
        Empresas.add(ENGEUDI, gridBagConstraints);

        txtFogo.setMaximumSize(null);
        txtFogo.setMinimumSize(new java.awt.Dimension(50, 22));
        txtFogo.setPreferredSize(new java.awt.Dimension(50, 22));
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 4;
        gridBagConstraints.gridwidth = 3;
        gridBagConstraints.ipadx = 17;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.insets = new java.awt.Insets(6, 0, 0, 0);
        Empresas.add(txtFogo, gridBagConstraints);

        lbFogo.setText("Nº Fogo");
        lbFogo.setHorizontalTextPosition(javax.swing.SwingConstants.LEADING);
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 3;
        gridBagConstraints.ipady = 10;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.insets = new java.awt.Insets(2, 0, 0, 0);
        Empresas.add(lbFogo, gridBagConstraints);

        Novo.setText("Novo Cadastro");
        Novo.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                NovoActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jScrollPane)
                    .addGroup(layout.createSequentialGroup()
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                                .addContainerGap()
                                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addComponent(Empresas, javax.swing.GroupLayout.PREFERRED_SIZE, 167, javax.swing.GroupLayout.PREFERRED_SIZE)
                                    .addComponent(Novo))
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                .addComponent(jCadastro2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                .addComponent(jCadastro1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                            .addGroup(layout.createSequentialGroup()
                                .addGap(22, 22, 22)
                                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addComponent(btnCadastrar, javax.swing.GroupLayout.PREFERRED_SIZE, 110, javax.swing.GroupLayout.PREFERRED_SIZE)
                                    .addGroup(layout.createSequentialGroup()
                                        .addGap(814, 814, 814)
                                        .addComponent(btnExcluir, javax.swing.GroupLayout.PREFERRED_SIZE, 110, javax.swing.GroupLayout.PREFERRED_SIZE)))))
                        .addGap(0, 48, Short.MAX_VALUE)))
                .addContainerGap())
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jCadastro2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jCadastro1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addGroup(layout.createSequentialGroup()
                        .addComponent(Empresas, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(51, 51, 51)
                        .addComponent(Novo)))
                .addGap(18, 18, 18)
                .addComponent(jScrollPane, javax.swing.GroupLayout.DEFAULT_SIZE, 300, Short.MAX_VALUE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(btnCadastrar, javax.swing.GroupLayout.PREFERRED_SIZE, 50, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(btnExcluir, javax.swing.GroupLayout.PREFERRED_SIZE, 50, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(32, 32, 32))
        );

        getAccessibleContext().setAccessibleName("TelaCadastroPneus");

        setSize(new java.awt.Dimension(1110, 662));
        setLocationRelativeTo(null);
    }// </editor-fold>//GEN-END:initComponents

    private void btnCadastrarActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnCadastrarActionPerformed
        int idEmpresa = 0;
        if (MARTINS_BORGES.isSelected()) {
            idEmpresa = 1;
        } else if (ALB.isSelected()) {
            idEmpresa = 2;
        } else if (ENGEUDI.isSelected()) {
            idEmpresa = 3;
        }

        String fogoDigitado = txtFogo.getText().trim();

        if (idEmpresa == 0) {
            JOptionPane.showMessageDialog(this, "Selecione a Empresa Proprietária.", "Campo Obrigatório", JOptionPane.WARNING_MESSAGE);
            MARTINS_BORGES.requestFocusInWindow();
            return;
        }

        String fornecedor = resolveComboBoxSelection(CbFornecedor, fornecedorNomes, "Fornecedor");
        if (fornecedor == null) return;

        String fabricante = resolveComboBoxSelection(CbFabricante, fabricanteNomes, "Fabricante");
        if (fabricante == null) return;

        String tipoPneu = resolveComboBoxSelection(CbTipoPneu, tipoPneuNomes, "Tipo Pneu");
        if (tipoPneu == null) return;

        String modelo = resolveComboBoxSelection(CbModelo, modeloPneuNomes, "Modelo");
        if (modelo == null) return;

        String medida = resolveComboBoxSelection(CbMedida, medidaPneuNomes, "Medida");
        if (medida == null) return;

        String dot = TxtDot.getText().trim().toUpperCase();
        String profundidadeStr = TxtProfud.getText().trim().replace(",", ".");
        String nRecapStr = TxtRecap.getText().trim();
        String projecaoKmStr = TxtProjecao.getText().trim();
        String obs = TxtObs.getText().trim().toUpperCase();
        String valorTexto = TxtValor.getText().trim();

        if (dot.isEmpty()) {
            JOptionPane.showMessageDialog(this, "O campo 'Dot' é obrigatório.", "Campo Obrigatório", JOptionPane.WARNING_MESSAGE);
            TxtDot.requestFocusInWindow();
            return;
        }

        Double valor = null; Double profundidade = null; Integer nRecapagens = null; Integer projecaoKm = null;
        try {
            if (valorTexto != null && !valorTexto.trim().isEmpty()) {
                try { Number valorNum = currencyFormat.parse(valorTexto); valor = valorNum.doubleValue(); }
                catch (java.text.ParseException pe) { String valorNumerico = valorTexto.replace("R$", "").replace(".", "").replace(",", ".").trim(); if (!valorNumerico.isEmpty()) { valor = Double.parseDouble(valorNumerico); } else { valor = 0.0; }}
                if (valor != null && valor < 0) { throw new NumberFormatException("Valor não pode ser negativo."); }
            } else { valor = 0.0; }
            if (profundidadeStr.isEmpty()) { throw new NumberFormatException("Profundidade é obrigatória."); }
            profundidade = Double.parseDouble(profundidadeStr); if (profundidade < 0) { throw new NumberFormatException("Profundidade negativa."); }
            if (nRecapStr.isEmpty()) { throw new NumberFormatException("N° Recapagens é obrigatório."); }
            nRecapagens = Integer.parseInt(nRecapStr); if (nRecapagens < 0) { throw new NumberFormatException("N° Recap. negativo."); }
            if (!projecaoKmStr.isEmpty()) { projecaoKm = Integer.parseInt(projecaoKmStr); if (projecaoKm < 0) { throw new NumberFormatException("Projeção Km negativa."); } }
        } catch (NumberFormatException e) { JOptionPane.showMessageDialog(this, "Erro em Campo Numérico:\n" + e.getMessage(), "Inválido", JOptionPane.ERROR_MESSAGE); return; } 

        Pneu pneu = new Pneu();
        pneu.setIdEmpresaProprietaria(idEmpresa);
        pneu.setFogo(fogoDigitado);
        pneu.setFornecedor(fornecedor);
        pneu.setValor(valor);
        pneu.setFabricante(fabricante);
        pneu.setTipoPneu(tipoPneu);
        pneu.setModelo(modelo);
        pneu.setDot(dot);
        pneu.setMedida(medida);
        pneu.setProfundidade(profundidade);
        pneu.setDataCadastro(LocalDate.now());
        pneu.setnRecapagens(nRecapagens != null ? nRecapagens : 0);
        pneu.setProjetadoKm(projecaoKm);
        pneu.setObservacoes(obs);
        
        boolean sucesso;
        String operacao = ""; 
        if (modoEdicao) {
            operacao = "atualizar";
            if (idPneuEmEdicao <= 0) { JOptionPane.showMessageDialog(this, "ID inválido para atualização.", "Erro", JOptionPane.ERROR_MESSAGE); return; }
            pneu.setId(idPneuEmEdicao);

            sucesso = pneuDAO.atualizarPneu(pneu);
        } else {
            operacao = "cadastrar";
            sucesso = pneuDAO.inserirPneu(pneu);
        }

        if (sucesso) {
            JOptionPane.showMessageDialog(this, "Pneu " + (modoEdicao ? "atualizado" : "cadastrado") + "!", "Sucesso", JOptionPane.INFORMATION_MESSAGE);
            if (modoEdicao) {
                cancelarEdicao(); 
            } else {
                limparCampos(); 
                if (onCadastroSucessoCallback != null) {
                    onCadastroSucessoCallback.run();
                }
            }
            atualizarTabelaDados();
            
            // Notifica o listener sobre a alteração nos dados
            if (dataChangeListener != null) {
                dataChangeListener.onPneuDataChanged();
            }
        } else {
            JOptionPane.showMessageDialog(this, "Falha ao " + operacao + " pneu.", "Erro DAO", JOptionPane.ERROR_MESSAGE);
            
        }

    }//GEN-LAST:event_btnCadastrarActionPerformed

    private void btnExcluirActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnExcluirActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_btnExcluirActionPerformed

    private void btnNovoTipoPneuActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnNovoTipoPneuActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_btnNovoTipoPneuActionPerformed

    private void btnEditarTipoPneuActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnEditarTipoPneuActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_btnEditarTipoPneuActionPerformed

    private void btnNovoFornecedorActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnNovoFornecedorActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_btnNovoFornecedorActionPerformed

    private void btnNovoFabricanteActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnNovoFabricanteActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_btnNovoFabricanteActionPerformed

    private void btnNovoModeloActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnNovoModeloActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_btnNovoModeloActionPerformed

    private void btnNovoMedidaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnNovoMedidaActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_btnNovoMedidaActionPerformed

    private void btnEditarMedidaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnEditarMedidaActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_btnEditarMedidaActionPerformed

    private void btnEditarFornecedorActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnEditarFornecedorActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_btnEditarFornecedorActionPerformed

    private void btnEditarModeloActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnEditarModeloActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_btnEditarModeloActionPerformed

    private void btnEditarFabricanteActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnEditarFabricanteActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_btnEditarFabricanteActionPerformed

    private void Tabela_ExibicaoMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_Tabela_ExibicaoMouseClicked
        // TODO add your handling code here:
    }//GEN-LAST:event_Tabela_ExibicaoMouseClicked

    private void jScrollPaneMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_jScrollPaneMouseClicked
        // TODO add your handling code here:
    }//GEN-LAST:event_jScrollPaneMouseClicked

    private void NovoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_NovoActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_NovoActionPerformed
    
    private void configurarAutoCompletar(JComboBox<String> comboBox) {
        // Configura o editor do ComboBox para permitir digitação
        comboBox.setEditable(true);
        
        // Obtém o editor do ComboBox
        JTextField editor = (JTextField) comboBox.getEditor().getEditorComponent();
        
        // Adiciona um DocumentListener para filtrar os itens
        editor.getDocument().addDocumentListener(new DocumentListener() {
            @Override
            public void insertUpdate(DocumentEvent e) {
                filtrarComboBox(comboBox, editor.getText());
            }
            
            @Override
            public void removeUpdate(DocumentEvent e) {
                filtrarComboBox(comboBox, editor.getText());
            }
            
            @Override
            public void changedUpdate(DocumentEvent e) {
                // Não é necessário para JTextField
            }
        });
        
        // Adiciona um KeyListener para navegação
        editor.addKeyListener(new KeyAdapter() {
            @Override
            public void keyPressed(KeyEvent e) {
                if (e.getKeyCode() == KeyEvent.VK_ENTER) {
                    // Seleciona o item atual se for válido
                    String texto = editor.getText();
                    if (!texto.isEmpty()) {
                        // Procura por um item que corresponda ao texto
                        for (int i = 0; i < comboBox.getItemCount(); i++) {
                            String item = comboBox.getItemAt(i);
                            if (item != null && item.equalsIgnoreCase(texto)) {
                                comboBox.setSelectedIndex(i);
                                break;
                            }
                        }
                    }
                }
            }
        });
    }
    
    private void filtrarComboBox(JComboBox<String> comboBox, String filtro) {
        if (filtro == null || filtro.isEmpty()) {
            // Se não há filtro, mostra todos os itens
            comboBox.showPopup();
            return;
        }
        
        // Filtra os itens que começam com o texto digitado (case-insensitive)
        String filtroLower = filtro.toLowerCase();
        for (int i = 0; i < comboBox.getItemCount(); i++) {
            String item = comboBox.getItemAt(i);
            if (item != null && item.toLowerCase().startsWith(filtroLower)) {
                comboBox.setSelectedIndex(i);
                comboBox.showPopup();
                return;
            }
        }
    }
   
    public static void main(String args[]) {
        
        try {
            for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
                if ("Nimbus".equals(info.getName())) {
                    javax.swing.UIManager.setLookAndFeel(info.getClassName());
                    break;
                }
            }
        } catch (ClassNotFoundException | InstantiationException | IllegalAccessException | javax.swing.UnsupportedLookAndFeelException ex) {
            java.util.logging.Logger.getLogger(TelaCadastroPneus.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        }

        java.awt.EventQueue.invokeLater(() -> {
            TelaCadastroPneus dialog = new TelaCadastroPneus(new javax.swing.JFrame(), true);
            dialog.addWindowListener(new java.awt.event.WindowAdapter() {
                @Override
                public void windowClosing(java.awt.event.WindowEvent e) {
                    System.exit(0);
                }
            });
            dialog.setVisible(true);
        });
        
        

       
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                TelaCadastroPneus dialog = new TelaCadastroPneus(new javax.swing.JFrame(), true);
                dialog.addWindowListener(new java.awt.event.WindowAdapter() {
                    @Override
                    public void windowClosing(java.awt.event.WindowEvent e) {
                        System.exit(0);
                    }
                });
                dialog.setVisible(true);
            }
        });
    }

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JCheckBox ALB;
    private javax.swing.JComboBox<String> CbFabricante;
    private javax.swing.JComboBox<String> CbFornecedor;
    private javax.swing.JComboBox<String> CbMedida;
    private javax.swing.JComboBox<String> CbModelo;
    private javax.swing.JComboBox<String> CbTipoPneu;
    private javax.swing.JCheckBox ENGEUDI;
    private javax.swing.JPanel Empresas;
    private javax.swing.JCheckBox MARTINS_BORGES;
    private javax.swing.JCheckBox Novo;
    private javax.swing.JTable Tabela_Exibicao;
    private javax.swing.JTextField TxtDot;
    private javax.swing.JTextField TxtObs;
    private javax.swing.JTextField TxtProfud;
    private javax.swing.JTextField TxtProjecao;
    private javax.swing.JTextField TxtRecap;
    private javax.swing.JTextField TxtValor;
    private javax.swing.JButton btnCadastrar;
    private javax.swing.JButton btnEditarFabricante;
    private javax.swing.JButton btnEditarFornecedor;
    private javax.swing.JButton btnEditarMedida;
    private javax.swing.JButton btnEditarModelo;
    private javax.swing.JButton btnEditarTipoPneu;
    private javax.swing.JButton btnExcluir;
    private javax.swing.JButton btnNovoFabricante;
    private javax.swing.JButton btnNovoFornecedor;
    private javax.swing.JButton btnNovoMedida;
    private javax.swing.JButton btnNovoModelo;
    private javax.swing.JButton btnNovoTipoPneu;
    private javax.swing.JPanel jCadastro1;
    private javax.swing.JPanel jCadastro2;
    private javax.swing.JScrollPane jScrollPane;
    private javax.swing.JLabel lbDot;
    private javax.swing.JLabel lbFabricante;
    private javax.swing.JLabel lbFogo;
    private javax.swing.JLabel lbMedida;
    private javax.swing.JLabel lbModelo;
    private javax.swing.JLabel lbObs;
    private javax.swing.JLabel lbProfundidade;
    private javax.swing.JLabel lbProjecao;
    private javax.swing.JLabel lbRecap;
    private javax.swing.JLabel lbTipo_pneu;
    private javax.swing.JLabel lbValor;
    private javax.swing.JLabel lb_Fornecedor;
    private javax.swing.JTextField txtFogo;
    // End of variables declaration//GEN-END:variables
}
